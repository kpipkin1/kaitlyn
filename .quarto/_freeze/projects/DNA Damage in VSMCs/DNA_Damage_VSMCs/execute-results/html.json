{
  "hash": "5a096c9fce22e430675b99264fa30951",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"DNA Damage in VSMCs\"\nauthor: \"Kaitlyn Pipkin\"\neditor: \n  markdown: \n    wrap: 72\n---\n\n\n\n# Set the working directory\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#setwd(\"C:/Users/kpipkin1/Documents/GitHub/kaitlyn/projects/DNA Damage in VSMCs\")\n```\n:::\n\n\n\n# Load the necessary libraries\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse) \nlibrary(readr) \nlibrary(ggplot2) \nlibrary(stringr) \n```\n:::\n\n\n\n# Read in all of the CSV files\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfile_paths <- list.files(pattern = \"\\\\.csv$\", full.names = TRUE)\n```\n:::\n\n\n\n# Read all of the data into 1 tibble\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nall_data<-file_paths %>%\n  set_names() %>%\n  map_dfr(read_csv, .id = \"filename\")\n```\n:::\n\n\n\n# Add Columns and define base_name to help join\n## header 2\n### header 3\n\nSample text \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nall_data <- all_data %>%\n  mutate(\n    base_name = filename %>%\n      basename() %>%\n      str_remove(\" \\\\(blue\\\\)| \\\\(green\\\\)\") %>%\n      str_remove(\"-summary\\\\.csv$\"),\n    day = str_extract(filename, \"\\\\d+d\"),\n    dosage = case_when(\n      str_detect(filename, \"0\\\\.1uM\") ~ \"0.1uM\",\n      str_detect(filename, \"0\\\\.2uM\") ~ \"0.2uM\",\n      str_detect(filename, \"0\\\\.4uM\") ~ \"0.4uM\",\n      str_detect(filename, \"no doxo\") ~ \"0uM\",\n      TRUE ~ NA_character_\n    ),\n    channel = case_when(\n      str_detect(filename, \"blue\") ~ \"blue\",\n      str_detect(filename, \"green\") ~ \"green\",\n      TRUE ~ NA_character_\n    )\n  )\n```\n:::\n\n\n\n# Separate Blue and Green columns and join based on day and dosage\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nblue <- all_data %>%\n  filter(channel == \"blue\") %>%\n  select(base_name, day, dosage, Count, `Total Area`, `Average Size`, `%Area`, Mean) %>%\n  rename_with(~ paste0(., \"_blue\"), -c(base_name, day, dosage))\n\ngreen <- all_data %>%\n  filter(channel == \"green\") %>%\n  select(base_name, Count, `Total Area`, `Average Size`, `%Area`, Mean) %>%\n  rename_with(~ paste0(., \"_green\"), -base_name)\n```\n:::\n\n\n\n# Join green and blue channel images together\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncombined <- inner_join(blue, green, by = \"base_name\")\n```\n:::\n\n\n\n# Calculate the percent of green area (yH2AX) normalized to the blue area (DAPI)\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncombined <- combined %>%\n  mutate(percent_gammaH2AX = (`%Area_green` / `%Area_blue`) * 100)\n```\n:::\n\n\n\n# Clean data and get rid of points that do not match, and any NA or missing values\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncombined <- combined %>%\n  filter(!is.na(dosage), !is.na(percent_gammaH2AX), !is.na(day)) %>%\n  mutate(\n    dosage = factor(dosage, levels = c(\"0uM\", \"0.1uM\", \"0.2uM\", \"0.4uM\")),\n    day = factor(day, levels = c(\"3d\", \"4d\", \"7d\", \"11d\"))\n  ) %>%\n  droplevels()\n```\n:::\n\n\n\n# Pick colors for the plot\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbox_fill <- c(\n  \"3d\" = \"#66c2a5\",  # green\n  \"4d\" = \"#fc8d62\",  # orange\n  \"7d\" = \"#8da0cb\",  # blue\n  \"11d\" = \"#e78ac3\"  # pink\n)\n```\n:::\n\n\n\n\n# Generate a combined plot with each timepoint separated by color, dosage on X axis and percent of coverage (yH2AX/DAPI) on the y axis\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(combined, aes(x = dosage, y = percent_gammaH2AX, fill = day)) +\n  geom_boxplot(position = position_dodge(width = 0.8), alpha = 0.4, width = 0.4, outlier.shape = NA) +\n  geom_jitter(aes(color = day), \n              position = position_jitterdodge(jitter.width = 0.2, dodge.width = 0.8), \n              size = 2, alpha = 0.8) +\n  scale_fill_manual(values = box_fill) +\n  scale_color_manual(values = box_fill) +\n  labs(\n    title = \"Assessing Dose- and Time-Dependent DNA Damage in VSMCs Following Doxorubicin Treatment\",\n    x = \"Doxorubicin Dose\",\n    y = \"% γH2AX / % DAPI\",\n    fill = \"Day\",\n    color = \"Day\"\n  ) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](DNA_Damage_VSMCs_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n\n# Plot the individual days separately to access DNA damage by dosage more clearly\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot_day <- function(day_label) {\n  combined %>%\n    filter(day == day_label) %>%\n    ggplot(aes(x = dosage, y = percent_gammaH2AX)) +\n    geom_boxplot(fill = box_fill[day_label], alpha = 0.4, width = 0.3, outlier.shape = NA) +\n    geom_jitter(color = box_fill[day_label], width = 0.15, size = 2, alpha = 0.8) +\n    labs(\n      title = paste(\"Dose-Dependent DNA Damage in VSMCs on\", day_label),\n      x = \"Doxorubicin Dose\",\n      y = \"% γH2AX / % DAPI\"\n    ) +\n    theme_minimal()\n}\n\n# Usage:\nplot_day(\"3d\")\n```\n\n::: {.cell-output-display}\n![](DNA_Damage_VSMCs_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n\n```{.r .cell-code}\nplot_day(\"4d\")\n```\n\n::: {.cell-output-display}\n![](DNA_Damage_VSMCs_files/figure-html/unnamed-chunk-12-2.png){width=672}\n:::\n\n```{.r .cell-code}\nplot_day(\"7d\")\n```\n\n::: {.cell-output-display}\n![](DNA_Damage_VSMCs_files/figure-html/unnamed-chunk-12-3.png){width=672}\n:::\n\n```{.r .cell-code}\nplot_day(\"11d\")\n```\n\n::: {.cell-output-display}\n![](DNA_Damage_VSMCs_files/figure-html/unnamed-chunk-12-4.png){width=672}\n:::\n:::\n",
    "supporting": [
      "DNA_Damage_VSMCs_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}